webpackJsonp([22],{Ktrr:function(e,t,n){var i=n("pBt2");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n("rjj0")("18d7fa88",i,!0)},pBt2:function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,"\n.container[data-v-2c248f77] {\n  width: 80%;\n  min-width: 400px;\n  margin: 0 auto;\n  padding-top: 50px;\n}\n.line[data-v-2c248f77] {\n  text-align: center;\n}\n.el-tag + .el-tag[data-v-2c248f77] {\n  margin-left: 10px;\n}\n.button-new-tag[data-v-2c248f77] {\n  margin-left: 10px;\n  height: 32px;\n  line-height: 30px;\n  padding-top: 0;\n  padding-bottom: 0;\n}\n.input-new-tag[data-v-2c248f77] {\n  width: 90px;\n  margin-left: 10px;\n  vertical-align: bottom;\n}\n.cover-uploader .el-upload[data-v-2c248f77] {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.cover-uploader .el-upload[data-v-2c248f77]:hover {\n  border-color: #409eff;\n}\n.cover-uploader-icon[data-v-2c248f77] {\n  font-size: 28px;\n  color: #8c939d;\n  width: 316px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.cover-uploader-icon[data-v-2c248f77]:hover {\n  border-color: #409eff;\n}\n.cover[data-v-2c248f77] {\n  width: 316px;\n  height: auto;\n  display: block;\n}\n",""])},sZNU:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("Xxa5"),a=n.n(i),o=n("exGp"),r=n.n(o),s=n("woOf"),l=n.n(s),c=n("Dd8w"),m=n.n(c),u=n("5aCZ"),f=n("Ty/O"),d=n("T452"),p=n("NYxO"),v={title:"",content:"",start_time:"",end_time:"",address:"",cover_image:"",end_join_time:"",video_url:"",can_join_online:0,join_form:[],join_fee:"",join_limit_number:-1,images:[]},_=function(){return l()({},v)},h={components:{Tinymce:u.a},name:"add",data:function(){return{id:0,isLimit:!1,inputVisible:!1,inputValue:"",basicForm:[{name:"姓名"},{name:"手机"}],fileList:[],tags:[],selectedTags:[],form:_()}},mounted:function(){this.$route.params.id&&(this.id=this.$route.params.id,this.handleData(this.id)),this.getTags()},computed:m()({},Object(p.c)({role:function(e){return e.user.roles}})),methods:{handleData:function(e){var t=this;return r()(a.a.mark(function n(){var i;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.a.getDetail(e);case 2:i=n.sent,t.form=(a=i.data,m()({},a,{start_time:1e3*a.start_time,end_time:1e3*a.end_time,end_join_time:1e3*a.end_join_time,join_form:JSON.parse(a.join_form),images:a.images.split(",")})),t.fileList=t.form.images.map(function(e){return{name:"",url:e}});case 5:case"end":return n.stop()}var a},n,t)}))()},getTags:function(){var e=this;return r()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a[e.role].AT.get();case 2:n=t.sent,e.tags=n.data.map(function(e){return m()({},e,{selected:!1})});case 4:case"end":return t.stop()}},t,e)}))()},handleTagSelect:function(e){this.tags[e].selected=!this.tags[e].selected},onSubmit:function(){var e=this;return r()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.form.tags=e.tags.filter(function(e){return e.selected}),t.prev=1,t.next=4,f.a.addActivity(e.form);case 4:e.$message("发布成功"),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(1);case 9:case"end":return t.stop()}},t,e,[[1,7]])}))()},handleClose:function(e){this.form.join_form.splice(this.form.join_form.indexOf(e),1)},handleCoverSuccess:function(e,t){this.form.cover_image=e.data},handleImagesSuccess:function(e,t){this.fileList.push(t),this.form.images.push(e.data)},handleImagesRemove:function(e){var t=this.fileList.indexOf(e);this.form.images.splice(t,1),this.fileList.splice(t,1)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},reset:function(){this.form=_()},handleInputConfirm:function(){var e=this.inputValue;e&&this.form.join_form.push({name:e}),this.inputVisible=!1,this.inputValue=""},handleSwitch:function(e){e||(this.form.join_limit_number=-1)}}},g={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{key:e.id,staticClass:"container"},[n("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[n("el-form-item",{attrs:{label:"活动标题"}},[n("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"开始时间"}},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.form.start_time,callback:function(t){e.$set(e.form,"start_time",t)},expression:"form.start_time"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"结束时间"}},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.form.end_time,callback:function(t){e.$set(e.form,"end_time",t)},expression:"form.end_time"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"报名截止时间"}},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.form.end_join_time,callback:function(t){e.$set(e.form,"end_join_time",t)},expression:"form.end_join_time"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"活动地点"}},[n("el-input",{model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"金额"}},[n("el-input",{attrs:{type:"number"},model:{value:e.form.join_fee,callback:function(t){e.$set(e.form,"join_fee",t)},expression:"form.join_fee"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"标签"}},e._l(e.tags,function(t,i){return n("el-tag",{key:i,staticStyle:{cursor:"pointer"},attrs:{type:t.selected?"success":"info"},nativeOn:{click:function(t){e.handleTagSelect(i)}}},[e._v("\n      "+e._s(t.name)+"\n    ")])})),e._v(" "),n("el-form-item",{attrs:{label:"报名人数上限"}},[n("el-row",[n("el-col",{attrs:{span:2}},[n("el-switch",{on:{change:e.handleSwitch},model:{value:e.isLimit,callback:function(t){e.isLimit=t},expression:"isLimit"}})],1),e._v(" "),n("el-col",{attrs:{span:3}},[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.isLimit,expression:"isLimit"}],attrs:{type:"number"},model:{value:e.form.join_limit_number,callback:function(t){e.$set(e.form,"join_limit_number",t)},expression:"form.join_limit_number"}})],1)],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"开通在线报名"}},[n("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.form.can_join_online,callback:function(t){e.$set(e.form,"can_join_online",t)},expression:"form.can_join_online"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"封面图片"}},[n("el-upload",{staticClass:"cover-uploader",attrs:{action:"/"+e.role+"/common/upload",name:"files[]",headers:{isAjax:1},"with-credentials":!0,"show-file-list":!1,"on-success":e.handleCoverSuccess}},[e.form.cover_image?n("img",{staticClass:"cover",attrs:{src:e.form.cover_image}}):n("i",{staticClass:"el-icon-plus cover-uploader-icon"}),e._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件")])])],1),e._v(" "),n("el-form-item",{attrs:{label:"顶部滚动图"}},[n("el-upload",{attrs:{name:"files[]",action:"/"+e.role+"/common/upload","list-type":"picture",headers:{isAjax:1},"with-credentials":!0,"file-list":e.fileList,"on-success":e.handleImagesSuccess,"on-remove":e.handleImagesRemove}},[n("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件")])],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"报名设置"}},[e._l(e.basicForm,function(t,i){return n("el-tag",{key:"basic-tag"+i,attrs:{"disable-transitions":!1},on:{close:function(n){e.handleClose(t)}}},[e._v("\n    "+e._s(t.name)+"\n  ")])}),e._v(" "),e._l(e.form.join_form,function(t,i){return n("el-tag",{key:"tag"+i,attrs:{closable:"","disable-transitions":!1},on:{close:function(n){e.handleClose(t)}}},[e._v("\n    "+e._s(t.name)+"\n  ")])}),e._v(" "),e.inputVisible?n("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.handleInputConfirm(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):n("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput}},[e._v("+ 新增报名项")])],2),e._v(" "),n("el-form-item",{attrs:{label:"活动描述"}},[n("tinymce",{attrs:{height:400},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即创建")]),e._v(" "),n("el-button",{on:{click:e.reset}},[e._v("清空")])],1)],1)],1)},staticRenderFns:[]};var b=n("VU/8")(h,g,!1,function(e){n("Ktrr")},"data-v-2c248f77",null);t.default=b.exports}});